# Excel Report 处理工具

## 环境搭建
  1. 安装 git
  2. 安装 node
  3. 设置npm淘宝镜像：`npm config set registry https://registry.npm.taobao.org --global`
  4. 拉取仓库 `git clone https://github.com/delbury/excel-report.git`
  5. 进入项目文件夹 `cd ./excel-report`
  6. 切换分支 `git checkout -b customized origin/customized`
  7. 安装依赖 `npm ci`
  8. 更新代码 `git pull`
  9. 打包 `npm run build`
## Excel 导入部分
### Excel Sheet 过滤逻辑
  1. 过滤表中存在合并单元格的行
  2. 从第一非空行开始取从 A 列开始的最长非空连续列解析为表头字段
  3. 余下的非空行按照 “步骤2” 中获取的表头字段组装表格数据


---
## 数据逻辑
|符号|意义|
|---|---|
|O  |原始表|
|R  |结果表|
### 培训分析处理
统计分析单位维度为机电三车间，再以工班为维度统计分析
  - #### 培训-技能表
    - 需要从上方导入本地 “月度培训明细表”
    - 数据过滤公式：
      - `O.V(角色) === '培训师' && O.H(培训项目名称) === '必知必会培训'`
    - 数据统计维度：
      - 月份：`O.B(日期).getMonth()`
    - 生成字段公式：
      - 单位：`O.F(培训组织单位)`、`O.G(培训组织班组)`
      - 月份：`O.B(日期).getMonth()`
      - 培训项目数：`当前维度的数据总条数`
      - 培训总人次：`O.AD(总人数)逐条累加`
      - 理论培训课时：`O.AE(理论课时)逐条累加`
      - 实操培训课时：`O.AF(实操课时)逐条累加`

  - #### 培训-情况表
    - 需要从上方导入本地 “月度培训明细表”
    - 数据过滤公式：
      - `O.V(角色) === '培训师'`
    - 数据统计维度：
      - 月份：`O.B(日期).getMonth()`
      - 岗位：`O.Y(管理和业务技术) > 0 则为 '管理和业务技术'; O.AA(生产人员) > 0 则为 '生产人员';`
    - 生成字段公式：
      - 单位：`O.F(培训组织单位)`、`O.G(培训组织班组)`
      - 岗位：`O.Y(管理和业务技术) > 0 则为 '管理和业务技术'; O.AA(生产人员) > 0 则为 '生产人员';`
      - 月份：`O.B(日期).getMonth()`
      - 现员人数：`可编辑，默认值：R.岗位 === '管理和业务技术' 则为 19; R.岗位 === '生产人员' 则为 122`
      - 培训课时：`O.AG(总课时) * (O.Y(管理和业务技术) + O.AA(生产人员))并逐行累加`
      - 培训条数：`当前维度数据总条数`
      - 培训人次：`(O.Y(管理和业务技术) + O.AA(生产人员))并逐行累加`
      - 人均培训课时（小时）：`R.培训课时 / R.现员人数`
      - 年度累计人均课时（小时）：`R.上一个月.人均培训课时（小时）+ R.培训课时 / R.现员人数`
      - 年度培训课时完成率：`R.岗位 === '管理和业务技术' 则为 R.年度累计人均课时（小时）/ 42; R.岗位 === '生产人员' 则为 R.年度累计人均课时（小时）/ 60`

  - #### 培训-讲师表
    - 需要从上方导入本地 “月度培训明细表”
    - 数据过滤公式：
      - `['见习', '一星', '二星', '三星', '四星', '五星'].has(O.W(培训师星级))`
    - 数据统计维度：
      - 月份：`O.B(日期).getMonth()`
    - 生成字段公式：
      - 单位：`O.F(培训组织单位)`、`O.G(培训组织班组)`
      - 月份：`O.B(日期).getMonth()`
      - 培训师人数：`可编辑，默认值：7`
      - 培训师授课人数：`当月不同 O.T(姓名) 的人数`
      - 培训师利用率： `R.培训师授课人数 / R.培训师人数`
      - 总授课学时： `O.AG(总课时)逐行累加`
      - 人均授课学时： `R.总授课学时 / R.培训师授课人数`

  - #### 知会-评估表
    - 需要从上方导入本地 “必知必会评估明细表”
    - 数据过滤公式：
      - `专业列表.has(O.K(设备维保必知必会技能名称)) && !!O.J(考试日期)`
    - 数据统计维度：
      - 月份：`O.J(日期).getMonth()`
    - 生成字段公式：
      - 单位： `O.G(车间名)`、`O.H(班组名称)`
      - 月份： `O.J(日期).getMonth()`
      - 评估项目数： `当月不同的 O.K(设备维保必知必会技能名称) 总数`
      - 评估人次： `!!O.O(验收结果) === true 的总数`
      - 通过人次： `O.O(验收结果) === '通过' 的总数`
      - 未通过人次： `O.O(验收结果) === '不通过' 的总数`
      - 合格率： `R.通过人次： / R.评估人次`
      - 理论验收人次： `O.M(考试类型) === '理论' 的总数`
      - 实操验收人次： `O.M(考试类型) === '实操' 的总数`
---
### 考评成绩处理
#### Excel 文件模板（字段列对应）
  - ##### 车间通讯录文件（文件第一张表）
    - 姓名：A
    - 职务：D
    - 部门/单位：E
    - 手机：G

  - ##### 委外通讯录文件（文件第一张表）
    - 姓名：A(单位-姓名)
    - 职务：D
    - 部门/单位：A(单位-姓名)
    - 手机：G

  - ##### 委外花名册文件（表名必须一致）
    - 十二局
      - 姓名：D
      - 职务：F
      - 部门/单位：C
      - 手机：J

    - 正立
      - 姓名：C
      - 职务：E
      - 部门/单位：B
      - 手机：J

    - 上海三菱
      - 姓名：C
      - 职务：E
      - 部门/单位：B
      - 手机：I

    - 奥的斯
      - 姓名：C
      - 职务：E
      - 部门/单位：B
      - 手机：I

    - 迅达
      - 姓名：C
      - 职务：E
      - 部门/单位：B
      - 手机：I

    - 今创
      - 姓名：C
      - 职务：D
      - 部门/单位：B
      - 手机：H

    - 惠民
      - 姓名：C
      - 职务：E
      - 部门/单位：B
      - 手机：I

    - 维创
      - 姓名：C
      - 职务：E
      - 部门/单位：B
      - 手机：I

  - ##### 成绩文件（文件第一张表的第 8 行开始统计）
    - 姓名：B
    - 手机：C
    - 得分：D
    - 是否通过：E
    - 交卷时间：F
    - 考试用时：G
    - 员工编码：H
    - 所属专业：I
    - 所在单位：J